<% layout('layouts/Boilerplate') %>
<div id="cluster-map"></div>
<div class="d-flex flex-row col-md-12 mb-3">
	<h1>All Campgrounds</h1>
	<div class="my-auto mx-4">
		<a class="btn btn-primary" href="/campgrounds/new">Create new campground</a>
	</div>
</div>

<% for(let campground of campgrounds) {%>
<div class="card mb-3 col-md-4 col-lg-3 px-3">
	<div class="col-md-12">
		<% if(campground.images.length){%>
		<img
			crossorigin="anonymous"
			class="img-fluid mx-auto d-block"
			style="height: 15rem"
			src="<%= campground.images[0].url %>"
			alt="" />
		<% }else { %>
		<img crossorigin="anonymous" class="img-fluid" src="" alt="" />
		<% } %>
	</div>
	<div class="col-md-8">
		<div class="card-body">
			<h5 class="card-title"><%= campground.title %></h5>
			<p class="card-text"><%= campground.description %></p>
			<p class="card-text">
				<small class="text-muted"><%= campground.location %></small>
			</p>
			<a href="/campgrounds/<%= campground._id %>" class="btn btn-info">View</a>
		</div>
	</div>
</div>
<% } %>

<script>
	const mapToken = '<%-process.env.MAPBOX_TOKEN%>';
	const campgrounds = {features: <%- JSON.stringify(campgrounds)%>};
</script>
<script src="/javascripts/clusterMap.js"></script>
